\documentclass[oneside,a4paper,12pt]{article}

% -------------------------------------------------------
%  Packages
% -------------------------------------------------------
\usepackage{amssymb,amsmath}
\usepackage[colorlinks,linkcolor=blue,citecolor=blue]{hyperref}
\usepackage{graphicx,subfigure,wrapfig}
\usepackage{geometry}
\usepackage{multicol}
\usepackage{multirow}
\usepackage[figureposition=bottom,tableposition=top,font={small,bf},labelfont=bf]{caption}
\usepackage{algorithmicx,algorithm}
\usepackage[noend]{algpseudocode}
\usepackage[localise=on,extrafootnotefeatures]{xepersian}

% -------------------------------------------------------
%  Layout & Fonts
% -------------------------------------------------------
\newgeometry{margin=1in,bottom=1.1in,footskip=.4in}
\renewcommand{\baselinestretch}{1.4}
\linespread{1.6}
\setlength{\parskip}{0.45em}

% Set Fonts - adjusting to use likely available system fonts or defaulting
% If these fonts are not on the system, xepersian will error. 
% Assuming the user has a standard Iranian TeX setup.
\settextfont[Scale=1.166666666666666]{XBNiloofar}
\setdigitfont{Yas}

% -------------------------------------------------------
%  Custom Commands
% -------------------------------------------------------
\newcommand{\OPT}{\ensuremath{\mathop{\mathrm{OPT}}}}
\newcommand{\APX}{\ensuremath{\mathop{\mathrm{APX}}}}
\newcommand{\ALG}{\ensuremath{\mathop{\mathrm{ALG}}}}
\newcommand{\IN}{\ensuremath{\mathbb{N}}} 
\newcommand{\IR}{\ensuremath{\mathbb{R}}} 

\newcommand{\مهم}[1]{\textbf{#1}}
\renewcommand{\برچسب}{\label}
\newcommand{\لر}{\lr}
\newcommand{\کد}[1]{\lr{\tt #1}}

% Graphics
\graphicspath{{figs/}}
\newcommand{\centerimg}[2]{\vspace{1em}\begin{center}\includegraphics[width=#2]{#1}\end{center}\vspace{-1.5em}}

% -------------------------------------------------------
%  Algorithm Persian Definitions
% -------------------------------------------------------
\newenvironment{الگوریتم}[1]
	{\bigskip\bigskip\begin{algorithm}\caption{#1} \label{الگوریتم: #1}\vspace{0.5em}\begin{algorithmic}[1]}
	{\end{algorithmic}\vspace{0.5em}\end{algorithm}\bigskip}

\renewcommand{\algorithmicfor}{{به ازای}}
\renewcommand{\algorithmicwhile}{{تا وقتی}}
\renewcommand{\algorithmicdo}{\hspace{-.2em}:}
\renewcommand{\algorithmicif}{{اگر}}
\renewcommand{\algorithmicthen}{\hspace{-.2em}:}
\renewcommand{\algorithmicelse}{{در غیر این صورت:}}
\renewcommand{\algorithmicreturn}{{برگردان}}
\renewcommand{\algorithmiccomment}[1]{$\triangleleft$ \emph{#1}}
\renewcommand{\algorithmicrequire}{\textbf{ورودی:}}
\renewcommand{\algorithmicensure}{\textbf{خروجی:}}

\newcommand{\اگر}{\If}
\newcommand{\وگرنه}{\Else}
\newcommand{\وگر}{\ElsIf}
\newcommand{\پایان‌اگر}{\EndIf}
\newcommand{\به‌ازای}{\For}
\newcommand{\پایان‌به‌ازای}{\EndFor}
\newcommand{\تاوقتی}{\While}
\newcommand{\پایان‌تاوقتی}{\EndWhile}
\newcommand{\دستور}{\State}

% -------------------------------------------------------
%  Project Info
% -------------------------------------------------------
\newcommand{\CourseReportTitle}{حل مسئله جانمایی کره‌ها با روش‌های کاهش گرادیان و شبه نیوتونی}
\newcommand{\EnglishCourseTitle}{Solving Sphere Packing Problem using Gradient Descent and Quasi-Newton Methods}
\newcommand{\GroupeMembers}{محمدمحسن عباس‌زاده\\سینا دانشگر}
\newcommand{\CourseName}{آشنایی با بهینه‌سازی}
\newcommand{\courseSemester}{نیم‌سال اول ۱۴۰۳-۱۴۰۴}
\newcommand{\CourseProfessor}{کسری علیشاهی}
\newcommand{\Department}{دانشکده علوم ریاضی}
\newcommand{\University}{دانشگاه صنعتی شریف}


\begin{document}

% -------------------------------------------------------
%  Title Page
% -------------------------------------------------------
\pagestyle{empty}
\begin{center}
\includegraphics[scale=0.2]{logo.png}

\vspace{-0.2cm}
\University \\[-0.3em]
\Department\\

\vspace{2cm}

{عنوان:}\\[1.2em]
{\LARGE\textbf{\CourseReportTitle}}\\ 
\vspace{1cm}
\begin{latin}
{\Large\textbf\EnglishCourseTitle}
\end{latin}

\vspace{2cm}
{اعضای گروه}\\[.5em]
{\large\textbf{\GroupeMembers}}

\vspace{0.7cm}

{نام درس}\\[.5em]
{\large\textbf{\CourseName}}
\vspace{0.7cm}

{\large\textbf{\courseSemester}}

{نام استاد درس}\\[.5em]
{\large\textbf{\CourseProfessor}}

\vspace{1.2cm}

\end{center}
\newpage

\pagestyle{plain}
\pagenumbering{arabic}

% -------------------------------------------------------
%  Abstract & Context
% -------------------------------------------------------
\بدون‌تورفتگی \مهم{چکیده}:

این مطالعه به بررسی مسئله‌ی جانمایی بهینه کره‌ها در یک محیط محصور با استفاده از روش‌های کاهش گرادیان و شبه نیوتونی پرداخته است. در این تحقیق، دو روش بهینه‌سازی مستقیم مکان کره‌ها با استفاده از تابع انرژی پتانسیل و بهینه‌سازی تکراری مکان کره‌ها و شعاع ظرف مورد بررسی قرار گرفته‌اند. نتایج نشان می‌دهد که روش‌های مختلف در شرایط متفاوت می‌توانند کارایی و دقت‌های متفاوتی ارائه دهند. به علاوه، مسئله دوگان، کاربردهای علمی و صنعتی این مسئله و راهکارهای آتی برای بهبود نتایج بررسی شده‌اند.

\بدون‌تورفتگی \مهم{واژه‌های کلیدی}: 
تابع انرژی، شبه نیوتون، کاهش گرادیان، چیدمان بهینه کره‌ها

\section{مقدمه}

بسته‌بندی بهینه‌ی کره‌ها در یک محیط محصور، یکی از مسائل پایه‌ای در ریاضیات و علوم مهندسی است. این مسئله ارتباط مستقیمی با بهینه‌سازی ترکیبیاتی، نظریه‌ی کدگذاری، و مکانیک مواد دارد. در این مطالعه، به بررسی روش‌های مختلف حل این مسئله پرداخته و عملکرد آن‌ها را از نظر کارایی و دقت مورد تحلیل قرار داده‌ایم.

\subsection{تعریف مسئله}

مسئله‌ی مورد بررسی، یافتن کمترین شعاع R برای یک کره‌ی بزرگتر است که بتواند n کره‌ی کوچکتر با شعاع واحد را در خود جای دهد، به طوری که هیچ‌کدام از کره‌های کوچکتر با یکدیگر تداخل نداشته باشند. این مسئله معادل است با یافتن بهینه‌ترین چیدمان کره‌های کوچکتر درون کره‌ی بزرگتر.

\section{روش‌های مورد استفاده}

در این تحقیق، دو روش بهینه‌سازی برای حل مسئله بررسی شده‌اند:

\subsection{روش کاهش گرادیان}

این روش یکی از تکنیک‌های رایج در بهینه‌سازی عددی است که از مشتقات مرتبه اول تابع هدف برای یافتن جهت نزول استفاده می‌کند. در این روش، با حرکت در جهت منفی گرادیان، مقدار تابع هدف کاهش می‌یابد. یکی از چالش‌های این روش انتخاب گام مناسب برای به‌روزرسانی موقعیت کره‌ها در فضای جستجو است.

\subsection{روش شبه نیوتون}
این روش یک تکنیک پیشرفته‌تر نسبت به کاهش گرادیان است که از تقریب‌های ماتریس هسیان برای به‌روزرسانی گرادیان استفاده می‌کند. در این روش، اطلاعات مشتق دوم به‌طور ضمنی تخمین زده شده و سرعت همگرایی بهبود می‌یابد. یکی از مزایای این روش نسبت به کاهش گرادیان، نرخ همگرایی سریع‌تر آن به مینیمم محلی است.

\section{اید‌ه‌های حل مسئله}

\subsection{بهینه‌سازی مستقیم مکان کره‌ها با تعریف تابع انرژی پتانسیل}

\شروع{فقرات}
\فقره{ایدهٔ اصلی:}

در این روش، مسئله به عنوان یک مسئله‌ی بهینه‌سازی سراسری در نظر گرفته می‌شود. هدف، یافتن مکان‌هایی برای کره‌ها است که یک تابع انرژی پتانسیل مناسب را کمینه کند. \\

تابع پتانسیل زیر را در نظر بگیرید:
\[ 
\phi(x_1, x_2, ..., x_n) = \sum^{}_{i \neq j} \frac{1}{||x_i - x_j||} + \sum^{}_{i} ||x_i||^2
\]
که در آن $x_1, x_2, ... , x_n \in R^3$ نشان دهنده مکان n نقطه است و ||.|| نرم ۲ می‌باشد. \\
هدف کمینه کردن این تابع است. \\
جملهٔ اول، باعث می‌شود که نقاط تا جای ممکن از هم دور شوند. جملهٔ دوم، نقاط را در یک محدوده در نزدیکی مبدأ قرار می‌دهد. \\
این باید باعث شود تا نقاط درون یک کره، به صورت مناسب توزیع شوند.

\فقره{تخمین شعاع کره بزرگتر}
پس از یافتن مکان‌های بهینه برای کره‌ها با استفاده از روش کاهش گرادیان، فاصله نزدیک‌ترین نقاط را محاسبه کرده و بر 2 تقسیم می‌کنیم. حاصل را r در نظر می‌گیریم. سپس فاصله دورترین نقطه از مبدا را با r جمع کرده (عدم همپوشانی کره بزرگتر با کره‌های لب مرز) و نهایتا با تقسیم بر r شعاع کوچکترین کره‌ای که بتوان n کره واحد را در آن جای داد، به دست می‌آید.

\فقره{مشکلات و تلاش‌ها برای بهبود نتایج}
\شروع{فقرات}
یکی از مشکلات اصلی این روش، توزیع غیریکنواخت نقاط است. به دلیل ساختار تابع انرژی پتانسیل، نقاط در نزدیکی مبدأ فشرده‌تر هستند و هرچه از مبدأ دورتر می‌شویم، فشردگی آن‌ها کمتر می‌شود. این مسئله، باعث می‌شود که با بزرگ شدن تعداد کره‌های کوچک، جواب نهایی با خطا همراه باشد. مشکل دیگر، افتادن در بهینه‌های محلی‌ست که ناشی از انتخاب طول گام با روش Backtracking است. برای رفع این مشکل، تلاش‌هایی برای بهینه‌سازی تابع پتانسیل انجام دادیم، اما با شکست مواجه شد.

\فقره  \textbf{تغییر ضرایب و توان‌ها:}
یکی از تلاش‌ها، تغییر ضرایب و توان‌های جملات اول و دوم تابع پتانسیل بود. هدف این بود که با تغییر قدرت دافعه و جاذبه، توزیع یکنواخت‌تری از نقاط ایجاد شود. اما این تغییرات، نه تنها باعث بهبود نتایج نشد، بلکه در بسیاری از موارد، خطا را افزایش داد.

\فقره  \textbf{اضافه کردن جملهٔ سوم:}
تلاش دیگری که انجام شد، اضافه کردن یک جمله‌ی سوم به تابع پتانسیل بود. ایده‌ی اصلی این بود که یک پوسته‌ی کروی خارجی با بار همنام با نقاط فرض شود که نقاط دور از مرکز را به سمت مرکز هل دهد. اما این تلاش نیز با شکست مواجه شد و نتایج بهتری حاصل نشد.

\فقره  \textbf{استفاده از روش نیوتون:}
برای بهبود دقت نتایج، از روش نیوتون استفاده شد. از آنجا که روش نیوتون به نقطهٔ شروع حساس است، جواب نهایی روش کاهش گرادیان به عنوان نقطهٔ شروع روش نیوتون در نظر گرفته شد. اما این کار، تنها باعث افزایش زمان اجرا شد و بهبود قابل توجهی در دقت نتایج حاصل نشد. این مسئله احتمالاً به دلیل گیر افتادن در یک مینیمم محلی بوده‌است.

\فقره  \textbf{طول گام ثابت:}
در نهایت، به جای استفاده از طول گام متغیر که با روش Backtracking به‌دست می‌آمد، از یک طول گام ثابت $\alpha = 0.2$ استفاده شد. طول گام‌های مختلفی امتحان شد که در نهایت این مقدار، جواب‌های بهتری داد. این کار، باعث بهبود نسبی نتایج و کاهش زمان اجرا شد. \\ اما همچنان مشکل اصلی، یعنی توزیع غیریکنواخت نقاط، برطرف نشد...
\پایان{فقرات}

\subsection{بهینه‌سازی تکراری مکان کره‌ها و شعاع ظرف}

\فقره{ایدهٔ اصلی:}
در این روش، به جای بهینه‌سازی مستقیم مکان کره‌ها، یک رویکرد تکراری برای یافتن چیدمان بهینه کره‌ها و شعاع کره‌ی بزرگتر ارائه می‌شود. در این روش، ابتدا مکان‌های تصادفی برای کره‌ها در یک کره‌ی بزرگتر با شعاع اولیه‌ی $R_0$ تولید می‌شود. سپس، به صورت تکراری، مکان کره‌ها و شعاع کره‌ی بزرگتر بهینه می‌شوند.

\subsubsection{تابع انرژی پتانسیل}
تابع انرژی پتانسیل در این روش، مشابه روش اول است و از دو بخش انرژی دافعه و انرژی محدودسازی تشکیل شده است: \\
\[
O_{ij} = max(0, 2 - ||x_i - x_j||)
\]
\[
O_{i0} = max(0, ||x_i|| + 1 - R)
\]
\[
E(x) = \sum^{n}_{i=1} \sum^{}_{i \neq j} O_{ij}^2 [i < j] + \sum^{n}_{i=1} O_{i0}^2
\]
با این تفاوت که در این روش، شعاع R نیز به عنوان یک متغیر بهینه‌سازی در نظر گرفته می‌شود.
\textbf{توضیح:} جملهٔ اول، مشابه روش اول، به دنبال دور کردن نقاط از یکدیگر است. جملهٔ دوم، نقاط را درون کرهٔ بزرگتر محدود می‌کند. اگر نقطه‌ای از مرز کره (با در نظر گرفتن شعاع ۱ برای کره کوچک) خارج شود، یک نیروی بازگرداننده به آن اعمال می‌شود.

\subsubsection{الگوریتم BFGS}
الگوریتم BFGS یک روش شبه‌نیوتنی برای بهینه‌سازی توابع غیرخطی است. این الگوریتم از یک تقریب از ماتریس هسین استفاده می‌کند تا جهت جستجو را تعیین کند. در مقایسه با روش گرادیان کاهشی، BFGS معمولاً سریع‌تر به حل همگرا می‌شود زیرا از اطلاعات انحنای تابع هدف استفاده می‌کند.

\شروع{فقرات}
\فقره{مقداردهی اولیه:} 
\شروع{فقرات}
\فقره{موقعیت‌های اولیه به صورت تصادفی مقداردهی می‌شوند.}
\فقره{تقریب ماتریس هسین با یک ماتریس همانی مقداردهی می‌شود.}
\فقره{گرادیان اولیه محاسبه می‌شود.}
\پایان{فقرات}

\فقره{تکرار:}
\شروع{فقرات}
\فقره{تعیین جهت جستجو: جهت با استفاده از فرمول $direction = - H * grad_{old}$ محاسبه می‌شود. این جهت، جهتی‌ست که انتظار می‌رود تابع هدف در آن جهت کاهش یابد.}
\فقره{جستجوی خطی: اندازه گام با استفاده از جستجوی خطی تعیین می‌شود. جستجوی خطی به دنبال یافتن بهترین اندازه گام در جهت جستجو است، به طوری که تابع هدف به میزان کافی کاهش یابد.}
\فقره{موقعیت‌ها با استفاده از فرمول $positions = positions + \alpha * direction$ به روز رسانی می‌شوند.}
\فقره{گرادیان جدید در موقعیت‌های جدید محاسبه می‌شود.}
\فقره{تقریب ماتریس هسین با استفاده از فرمول BFGS به‌روزرسانی می‌شود. این فرمول از تغییرات در گرادیان و موقعیت‌ها برای بهبود تقریب ماتریس هسین استفاده می‌کند.}
\فقره{اگر تغییرات در موقعیت‌ها، کمتر از یک آستانه تحمل (tolerance) باشد، الگوریتم متوقف می‌شود.}
\پایان{فقرات}

\فقره{پارامترها و نحوهٔ تنظیم آن}
\شروع{فقرات}
\فقره{حداکثر تعداد تکرار: این پارامتر تعیین می‌کند که الگوریتم حداکثر چندبار تکرار شود. مقدار بزرگتر به الگوریتم فرصت بیشتری برای همگرایی می‌دهد. اما زمان اجرا افزایش می‌یابد. مقدار کوچکتر ممکن است باعث شود که الگوریتم به حل بهینه نرسد. معمولا مقادیر بین ۱۰۰ تا ۱۰۰۰ مناسب هستند.}
\فقره{آستانه تحمل: این پارامتر تعیین می‌کند که تغییرات در موقعیت‌ها باید کمتر از چه مقداری باشد تا الگوریتم متوقف شود. مقدار کوچکتر، دقت بیشتری را به همراه می‌آورد آما زمان اجرا را افزایش می‌دهد.}
\فقره{طول گام: این پارامتر به صورت خودکار توسط جستجوی خطی تنظیم می‌شود.}
\فقره{کاهندهٔ طول گام: این پارامتر تعیین می‌کند که اندازه گام در هر تکرار جستجوی خطی، چقدر کاهش یابد. مقدار کوچکتر، باعث می‌شود تا جستجوی خطی دقیق‌تر باشد. اما زمان اجرا را افزایش می‌دهد. معمولا مقدار $0.5$ مناسب است.}
\فقره{ثابت کوچک: این پارامتر در شرط کافی برای کاهش تابع هدف استفاده می‌شود. معمولا مقدار $0.01$ مناسب است.}
\پایان{فقرات}
\پایان{فقرات}

\newpage

\section{بررسی نتایج، مقایسه جواب‌ها در دو روش، و مقایسه با جواب بهینه}
در شکل ۱ مقایسه شعاع‌های دو روش با شعاع بهینه آورده شده است.

\شروع{شکل}[H]
\centerimg{Jadval1}{14cm}
\شرح{مقایسه شعاع‌های دو روش، با شعاع بهینه}
\برچسب{شکل:کیفیت}
\پایان{شکل}

در شکل ۲ خطای دو روش و همچنین زمان اجرای الگوریتم‌های آنان ارائه شده است.

\شروع{شکل}[H]
\centerimg{Jadval2}{14cm}
\شرح{مقایسه درصد خطا و زمان اجرای دو روش}
\برچسب{شکل:کیفیت}
\پایان{شکل}

همان‌طور که در شکل 2 مشاهده می‌شود با افزایش تعداد کره‌ها خطای روش اول بیشتر می‌شود، اما روش دوم همواره درصد خطای قابل قبولی دارد. در عوض زمان اجرای الگوریتم دوم با افزایش ابعاد مساله به صورت نمایی زیادتر می‌شود. مشاهده‌ی دیگر این است که در اکثر موارد روش دوم نسبت به تابع بهینه‌سازی خود متلب کمی دقت بالاتری دارد، اما زمان اجرای آن هم با افزایش مقدار n رشد بیشتری دارد. شکل‌های ۳ و ۴ به ترتیب نمودار زمان حل و کیفیت جواب‌های هر الگوریتم را بر حسب تعداد کره‌های واحد نشان می‌دهد.

\شروع{شکل}[H]
\centerimg{Picture1}{14cm}
\شرح{زمان حل الگوریتم‌های استفاده شده}
\برچسب{شکل:زمان}
\پایان{شکل}

\شروع{شکل}[H]
\centerimg{Picture2}{14cm}
\شرح{کیفیت جواب‌های دو روش استفاده شده، نسبت به جواب متلب و جواب بهینه}
\برچسب{شکل:کیفیت}
\پایان{شکل}

\newpage
شکل ۵ نمایش سه بعدی جواب‌های به دست آمده برای مقادیر مختلف n است.
\شروع{شکل}[H]
\centerimg{image}{15cm}
\شرح{نمایش سه بعدی جواب‌ها}
\برچسب{شکل:کیفیت}
\پایان{شکل}

\section{مسئله دوگان}
دوگان مسئلهٔ اصلی را، اینطور تعریف می‌کنیم که: \\
\textbf{یک کره به شعاع R داریم، حداکثر چند گوی واحد می‌توانیم در داخل آن جای دهیم؟}

به عبارتی، مسئلهٔ اصلی (Packing) به دنبال یافتن بهترین چیدمان برای تعداد مشخصی گوی در یک فضا است، در حالی که مسئله دوگان، به دنبال یافتن حداکثر تعداد گوی‌هایی است که می‌توان در یک فضای مشخص (مثلا کره‌ای با شعاع $R$) جای داد. \\
همانطور که در مقدمه ذکر کردیم، این مسئله کاربردهای گسترده‌ای در علوم و مهندسی دارد، من جمله موارد زیر: \\
\فقره{شیمی:} در بررسی نحوه قرارگیری مولکول‌ها در یک فضا، به خصوص در نانوشیمی و طراحی داروها.
\فقره{صنایع بسته‌بندی:} بهینه‌سازی فضای مورد استفاده در بسته‌بندی محصولات
\فقره{فیزیک:} بررسی ساختار اتمی مواد و آرایش ذرات در سیستم‌های مختلف

\section{جمع‌بندی}
به طور خلاصه، روش اول برای مسائلی که نیاز به دقت بالایی ندارند و سرعت اجرا در اولویت است مناسب است. در مقابل، روش دوم برای مسائلی که دقت بالا اهمیت بیشتری دارد و زمان اجرا محدودیتی ندارد، انتخاب بهتری است. همچنین، می‌توان از ترکیب این دو روش استفاده کرد.

\section{کارهای آتی}
\فقره{گوی‌هایی با شعاع‌های متفاوت}
\فقره{بررسی تاثیر شکل ظرف}
\فقره{بسته‌بندی کره در ابعاد بالاتر}
\فقره{استفاده از روش‌های یادگیری ماشین برای حل مسئله}
\فقره{بررسی اثر نیروهای خارجی}

\subsection{سوال جالب پیشنهادی}
\شروع{فقرات}
\فقره{چگونه می‌توان از خواص خود - سازمان‌دهی سیستم‌های فیزیکی (مثل نانو ذره‌ها) برای ایجاد چیدمان بهینه کره‌ها استفاده کرد؟}
\پایان{فقرات}


% -------------------------------------------------------
%  Bibliography
% -------------------------------------------------------
\clearpage
\phantomsection
\addcontentsline{toc}{chapter}{مراجع}

\begin{latin}
\baselineskip=.8\baselineskip
\footnotesize\bibliographystyle{ieeetr}
\bibliography{refs}
\end{latin}

\end{document}
